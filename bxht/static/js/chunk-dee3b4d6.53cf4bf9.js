(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dee3b4d6"],{"0369":function(e,a,t){"use strict";function l(e){return window.open(Object({NODE_ENV:"production",VUE_APP_CONFIG:"static/config.json",BASE_URL:""}).VUE_APP_BASE_API+"/export/"+e)}t.d(a,"a",(function(){return l}))},"09f4":function(e,a,t){"use strict";t.d(a,"a",(function(){return r})),Math.easeInOutQuad=function(e,a,t,l){return e/=l/2,e<1?t/2*e*e+a:(e--,-t/2*(e*(e-2)-1)+a)};var l=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function i(e,a){document.getElementsByClassName(e)[0].scrollTop=a}function n(e){if(e)return document.getElementsByClassName(e)[0].scrollTop;console.error("scrollTo缺少el对象")}function r(e,a,t,r){var s=n(e),o=a-s;if(0!==o){var c=20,u=0;t="undefined"===typeof t?500:t;var d=function a(){u+=c;var n=Math.easeInOutQuad(u,s,o,t);i(e,n),u<t?l(a):r&&"function"===typeof r&&r()};d()}}},"0ff1":function(e,a,t){"use strict";t("40b7")},"40b7":function(e,a,t){},"8a1c":function(e,a,t){"use strict";t("baca")},"9afd":function(e,a,t){"use strict";t.d(a,"a",(function(){return i}));var l=t("b775");function i(){return Object(l["a"])({url:"/dict/getAllWxlb",method:"get"})}},baca:function(e,a,t){},cf45:function(e,a,t){"use strict";t.d(a,"d",(function(){return i})),t.d(a,"a",(function(){return n})),t.d(a,"c",(function(){return r})),t.d(a,"b",(function(){return s}));t("c5f6");var l=t("5c96");function i(e){e=e||8;for(var a="",t=0;t<e;t++)a+=Math.floor(10*Math.random());return a}function n(e){return e&&JSON.parse(JSON.stringify(e))}function r(e,a){if(a=a||"请求成功！",e.status)if("false"==e.status){var t=Number(e.info);switch(t){case 0:l["Message"].error("未登录授权或无权限！");break;case 1:l["Message"].error("程序错误请刷新！");break;case 2:l["Message"].error("无效参数！");break;case 3:l["Message"].error("缺少传递必要参数！");break;default:l["Message"].error("接口异常，请重试！")}}else l["Message"].success(a);else l["Message"].success(a);return"success"==e.status}function s(e){var a={};for(var t in e)(e[t]||0===e[t])&&(a[t]=e[t]);return a}},d259:function(e,a,t){"use strict";t.r(a);var l=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"main pad10"},[t("div",{staticClass:"main-header"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.addHc}},[e._v("新增耗材")]),e._v(" "),t("el-button",{attrs:{type:"success",icon:"el-icon-refresh-right"},on:{click:function(a){return e.refreshHc("refresh")}}},[e._v("刷新")]),e._v(" "),t("el-input",{staticClass:"el-input-hc",attrs:{placeholder:"查询：请输入耗材名称","prefix-icon":"el-icon-search",clearable:""},model:{value:e.searchVal,callback:function(a){e.searchVal=a},expression:"searchVal"}})],1),e._v(" "),t("div",{ref:"main-content",staticClass:"main-content"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","min-width":"1500px"},attrs:{data:e.tableData.slice((e.paging.currentPage-1)*e.paging.pagesize,e.paging.currentPage*e.paging.pagesize),height:e.tableHeight,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"transparent",border:"","highlight-current-row":"","header-row-style":{color:"#01AAED"}}},[t("el-table-column",{attrs:{type:"index",width:"80",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"mc",label:"名称",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"jg",label:"单价",align:"center",sortable:""}}),e._v(" "),t("el-table-column",{attrs:{prop:"dw",label:"单位",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center",width:"300"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return e.hcUpdate(a.row)}}},[e._v("\n              修改\n            ")]),e._v(" "),t("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{onConfirm:e.handleHcDelete}},[t("el-button",{attrs:{slot:"reference",type:"danger",size:"small",plain:""},on:{click:function(t){return e.hcUDelete(a.row)}},slot:"reference"},[e._v("\n                删除\n              ")])],1)]}}])})],1)],1),e._v(" "),t("div",{staticClass:"main-footer"},[t("pagination",{attrs:{total:e.total,paging:e.paging},on:{pagination:e.handleSizeChange}})],1),e._v(" "),t("el-dialog",{staticClass:"hc-add-dialog",attrs:{title:"添加耗材",visible:e.dialogVisible,width:"560px",top:"150px",center:"","append-to-body":""},on:{"update:visible":function(a){e.dialogVisible=a}}},[t("div",{staticClass:"el-dialog-div"},[t("el-form",{ref:"ruleForm",attrs:{model:e.params,rules:e.rules,"label-position":"left","label-width":"100px"}},[t("el-form-item",{attrs:{label:"耗材类别",prop:"lb"}},[t("el-cascader",{staticClass:"cascader-bxlb",attrs:{placeholder:"选择耗材类别",props:{expandTrigger:"hover"},options:e.hclbOptions,filterable:"",clearable:""},on:{change:e.hclbOptionChange},model:{value:e.hclbval,callback:function(a){e.hclbval=a},expression:"hclbval"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"耗材名称",prop:"mc"}},[t("el-input",{attrs:{id:"addhcmc"},model:{value:e.params.mc,callback:function(a){e.$set(e.params,"mc",a)},expression:"params.mc"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"单价(元)",prop:"jg"}},[t("el-input",{model:{value:e.params.jg,callback:function(a){e.$set(e.params,"jg",a)},expression:"params.jg"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"单位",prop:"dw"}},[t("el-input",{model:{value:e.params.dw,callback:function(a){e.$set(e.params,"dw",a)},expression:"params.dw"}})],1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{plain:""},on:{click:function(a){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(a){return e.handleHcSubmit("insert","ruleForm")}}},[e._v("确 定")])],1)]),e._v(" "),t("el-dialog",{staticClass:"hc-add-dialog",attrs:{title:"修改耗材",visible:e.dialogVisibleUpdate,width:"560px",top:"150px",center:"","append-to-body":""},on:{"update:visible":function(a){e.dialogVisibleUpdate=a}}},[t("div",{staticClass:"el-dialog-div"},[t("el-form",{ref:"ruleForm",attrs:{model:e.paramsUpdate,rules:e.rules,"label-position":"left","label-width":"100px"}},[t("el-form-item",{attrs:{label:"耗材类别",prop:"lb"}},[t("el-cascader",{staticClass:"cascader-bxlb",attrs:{placeholder:"选择耗材类别",props:{expandTrigger:"hover"},options:e.hclbOptions,filterable:"",clearable:""},on:{change:e.hclbUpdateOptionChange},model:{value:e.hclbval,callback:function(a){e.hclbval=a},expression:"hclbval"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"耗材名称",prop:"mc"}},[t("el-input",{model:{value:e.paramsUpdate.mc,callback:function(a){e.$set(e.paramsUpdate,"mc",a)},expression:"paramsUpdate.mc"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"单价(元)",prop:"jg"}},[t("el-input",{model:{value:e.paramsUpdate.jg,callback:function(a){e.$set(e.paramsUpdate,"jg",a)},expression:"paramsUpdate.jg"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"单位",prop:"dw"}},[t("el-input",{model:{value:e.paramsUpdate.dw,callback:function(a){e.$set(e.paramsUpdate,"dw",a)},expression:"paramsUpdate.dw"}})],1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{plain:""},on:{click:function(a){e.dialogVisibleUpdate=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(a){return e.handleHcSubmit("update","ruleForm")}}},[e._v("确 定")])],1)]),e._v(" "),t("el-dialog",{staticClass:"hc-add-dialog",attrs:{title:"耗材补给",visible:e.hcSupplyDialogVisible,width:"560px",top:"150px",center:"","append-to-body":""},on:{"update:visible":function(a){e.hcSupplyDialogVisible=a}}},[t("div",{staticClass:"el-dialog-div"},[t("el-form",{ref:"hcRuleForm",attrs:{model:e.hcSupplyParams,rules:e.hcSupplyRules,"label-position":"left","label-width":"100px"}},[t("el-form-item",{attrs:{label:"数量",prop:"num"}},[t("el-input-number",{model:{value:e.hcSupplyParams.num,callback:function(a){e.$set(e.hcSupplyParams,"num",a)},expression:"hcSupplyParams.num"}})],1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{plain:""},on:{click:function(a){e.hcSupplyDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(a){return e.handleHcSubmit("add","hcRuleForm")}}},[e._v("确 定")])],1)]),e._v(" "),t("el-dialog",{staticClass:"hc-user-dialog",attrs:{title:e.hcUsageDialogTitle,visible:e.hcUsageDialogVisible,width:"1000px",top:"60px",center:"","append-to-body":""},on:{"update:visible":function(a){e.hcUsageDialogVisible=a}}},[t("div",{ref:"el-dialog-div",staticClass:"el-dialog-div"},[t("el-table",{ref:"hcTable",staticStyle:{width:"100%"},attrs:{data:e.hcUsageData,height:e.hcTableHeight,"highlight-current-row":"","header-row-style":{color:"#01AAED"},border:""}},[t("el-table-column",{attrs:{prop:"bid",label:"报修单号",width:"180",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"sj",label:"使用时间",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n              "+e._s(e.$moment(a.row.sj).format(e.format))+"\n            ")]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"yt",label:"用途",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n              "+e._s(a.row.bid?"使用":"补充")+"\n            ")]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"sl",label:"数量",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n              "+e._s(a.row.sl)+"\n            ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.bid?t("el-button",{attrs:{type:"danger",size:"small",plain:""},on:{click:function(t){return e.showBxd(a.row.bid)}}},[e._v("\n                查看报修单\n              ")]):e._e()]}}])})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(a){e.hcUsageDialogVisible=!1}}},[e._v("关 闭")])],1)]),e._v(" "),t("bxd-dialog",{attrs:{visible:e.bxdDialogVisible,bxdInfo:e.bxdInfo},on:{"update:visible":function(a){e.bxdDialogVisible=a}}})],1)},i=[],n=(t("ac6a"),t("456d"),t("9afd"),t("eb09")),r=t("b775");function s(e){return Object(r["a"])({url:"/HcServlet",method:"post",data:e})}var o=t("f121"),c=t("333d"),u=t("eeb4"),d=t("cf45"),p={name:"Material",components:{Pagination:c["a"],bxdDialog:u["a"]},data:function(){var e=function(e,a,t){if(!a)return t(new Error("此项不能为空"));var l=/^\d+(\.\d+)?$/;l.exec(a)?t():t(new Error("请输入有效数字值"))};return{hclbOptions:[{value:"0",label:"无需耗材 ",children:[{value:"0",label:"无需耗材"}]},{value:"1",label:"安装 ",children:[{value:"1",label:"电气设备安装工程-通用"},{value:"2",label:"电气设备安装工程-明装"},{value:"3",label:"电气设备安装工程-暗装"},{value:"4",label:"给排水、燃气工程"}]},{value:"2",label:"安装拆除 ",children:[{value:"1",label:"变配电及低压电器拆除"},{value:"2",label:"给排水、燃气工程拆除"},{value:"3",label:"消防工程拆除"}]},{value:"3",label:"拆除 ",children:[{value:"1",label:"人工拆除工程"},{value:"2",label:"机械拆除工程"},{value:"3",label:"其他项目"}]},{value:"4",label:"建筑",children:[{value:"1",label:"土（石）方工程"},{value:"2",label:"砌筑工程"},{value:"3",label:"屋面及防水工程"},{value:"4",label:"保温、隔热、防腐工程"},{value:"5",label:"脚手架工程"},{value:"6",label:"混凝土模板及支架(撑)"},{value:"7",label:"其他项目"},{value:"8",label:"特殊项目及机械台班"}]},{value:"5",label:"市政",children:[{value:"1",label:"市政"},{value:"2",label:"楼地面工程"},{value:"3",label:"墙、柱面工程"},{value:"4",label:"天棚工程"},{value:"5",label:"油漆、涂料、裱糊工程"},{value:"6",label:"其他装饰工程"},{value:"7",label:"门窗工程"},{value:"8",label:"玻璃价格调差"}]}],hclbval:[],options:[],loading:!1,tableHeight:null,addhc:[],hcData:[],hcUsageData:[],searchVal:"",format:"YYYY-MM-DD HH:mm",paging:Object(d["a"])(o["a"].paging),dialogVisible:!1,dialogVisibleUpdate:!1,hcUsageDialogVisible:!1,hcUsageDialogTitle:"",hcSupplyDialogVisible:!1,bxdDialogVisible:!1,bxdInfo:{},hcTableHeight:null,params:{lb:"",xh:"",op:"newhc",mc:"",jg:null,dw:""},paramsUpdate:{lb:"",xh:"",op:"uphc",id:"",mc:"",jg:null,dw:""},paramsDelete:{op:"delhc",id:""},rules:{lb:{required:!0,message:"请选择耗材类别",trigger:["blur","change"]},mc:{required:!0,message:"请填写名称",trigger:["blur","change"]},jg:[{required:!0,message:"请填写单价",trigger:["blur","change"]},{validator:e,trigger:"blur"}],kc:[{required:!0,message:"请填写库存数量",trigger:["blur","change"]},{validator:e,trigger:"blur"}],dw:[{required:!0,message:"请填写单位",trigger:["blur","change"]}]},hcSupplyParams:{op:"uphcforkc",hid:null,num:null},hcSupplyRules:{num:[{required:!0,message:"请填写补充数量",trigger:["blur","change"]},{validator:function(e,a,t){0===a?t(new Error("补充数量不能为0")):t()},trigger:"blur"}]}}},computed:{total:function(){return this.tableData.length},tableData:function(){var e=this.searchVal;return e?this.hcData.filter((function(a){return Object.keys(a).some((function(t){if("mc"===t)return String(a[t]).toLowerCase().indexOf(e)>-1}))})):this.hcData}},mounted:function(){this.tableHeight=this.$refs["main-content"].offsetHeight,this.getHcList()},methods:{hclbOptionChange:function(e){0!==e.length&&(this.params.lb=e[0],this.params.xh=e[1])},hclbUpdateOptionChange:function(e){0!==e.length&&(this.paramsUpdate.lb=e[0],this.paramsUpdate.xh=e[1])},hclbChange:function(e){0==e.length?this.params.lb="":(this.params.lb=e[0],this.params.xh=e[1])},hclbUpdate:function(e){0==e.length?this.paramsUpdate.lb="":this.paramsUpdate.lb=e[0]+"-"+e[1]},getHcList:function(e){var a=this;this.loading=!0,s({op:"selhc"}).then((function(t){a.loading=!1,a.hcData=t.obj.hlist,e&&a.$message.success("刷新成功")})).catch((function(){a.loading=!1,a.hcData=[],a.$message.error("接单人获取失败，请检查接口")}))},addHc:function(){this.dialogVisible=!0,this.resetForm("ruleForm");var e=$.fn.zTree.getZTreeObj("treeDemo"),a=e.getNodes(),t=e.transformToArray(a);this.addhc=t},handleHcSubmit:function(e,a){var t=this;this.$refs[a].validate((function(a){if(!a)return!1;"insert"===e?t.handleHcInsert():"add"===e?t.handleHcAdd():"update"===e&&t.handleHcUpdate()}))},resetForm:function(e){var a=this;this.$nextTick((function(){a.$refs[e].resetFields()}))},refreshHc:function(e){e&&(this.searchVal=""),this.getHcList(e)},handleSizeChange:function(e){this.paging.currentPage=e.currentPage,this.paging.pagesize=e.pagesize},hcUsage:function(e,a){var t=this;this.hcUsageDialogVisible=!0,this.hcUsageDialogTitle=a.mc?"【".concat(a.mc,"】使用情况"):"耗材使用情况",this.hcUsageData=a.sylist,this.$nextTick((function(){t.$refs["el-dialog-div"]&&(t.hcTableHeight=t.$refs["el-dialog-div"].offsetHeight)}))},hcSupply:function(e){this.hcSupplyDialogVisible=!0,this.hcSupplyParams.hid=e.id,this.resetForm("hcRuleForm")},hcUpdate:function(e){this.dialogVisibleUpdate=!0,this.paramsUpdate.id=e.id,this.paramsUpdate.mc=e.mc,this.paramsUpdate.jg=e.jg,this.paramsUpdate.dw=e.dw,this.paramsUpdate.xh=e.xh,this.paramsUpdate.lb=e.lb;var a=[e.lb,e.xh];this.hclbval=a},hcUDelete:function(e){this.paramsDelete.id=e.id,console.log("delete222============"),console.log(this.paramsDelete)},handleHcInsert:function(){var e=this;this.dialogVisible=!1,s(this.params).then((function(){e.$message.success("添加成功"),e.refreshHc()})).catch((function(){e.$message.error("添加失败，请重试")}))},handleHcAdd:function(){var e=this;this.hcSupplyDialogVisible=!1,this.searchVal="",s(this.hcSupplyParams).then((function(){e.$message.success("添加成功"),e.hcSupplyParams.hid=null,e.hcSupplyParams.num=null,e.refreshHc()})).catch((function(){e.$message.error("添加失败，请重试")}))},handleHcUpdate:function(){var e=this;this.dialogVisibleUpdate=!1,s(this.paramsUpdate).then((function(){e.$message.success("修改成功"),e.refreshHc()})).catch((function(){e.$message.error("修改失败，请重试")}))},handleHcDelete:function(){var e=this;s(this.paramsDelete).then((function(){e.$message.success("删除成功"),e.refreshHc()})).catch((function(){e.$message.error("删除失败，请重试")}))},showBxd:function(e){this.getBxdInfo(e)},getBxdInfo:function(e){var a=this,t=this.$loading({lock:!0,text:"正在获取报修单",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)",customClass:"bxd-loading"});Object(n["a"])({op:"bxlist",bid:e}).then((function(e){t.close(),a.bxdDialogVisible=!0,a.bxdInfo=e.blist[0]})).catch((function(){t.close(),a.$message.warning("报修单获取失败，请重新")}))}},watch:{addhc:{handler:function(e,a){for(var t="",l=0;l<e.length;l++)t=t+"/"+e[l].name;this.params.mc=t,console.log(t)},deep:!0}}},h=p,b=(t("0ff1"),t("8a1c"),t("2877")),g=Object(b["a"])(h,l,i,!1,null,"40c0591c",null);a["default"]=g.exports}}]);